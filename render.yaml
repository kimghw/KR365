services:
  - type: web
    name: mailquery-mcp-server
    runtime: python
    plan: free
    buildCommand: uv sync && echo "Build completed"
    startCommand: bash entrypoints/production/run_unified_http.sh --host 0.0.0.0 --port $PORT
    envVars:
      # ===========================
      # ğŸ”§ ë¹Œë“œ í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜
      # ===========================
      - key: PYTHON_VERSION
        value: "3.11.9"
      - key: UV_VERSION
        value: "0.7.12"
      - key: ENVIRONMENT
        value: "production"

      # ===========================
      # ğŸ”§ ê¸°ë³¸ ì„¤ì • (ì„ íƒì‚¬í•­)
      # ===========================
      - key: LOG_LEVEL
        value: "INFO"
      - key: DATABASE_PATH
        value: "./data/graphapi.db"
      - key: DCR_DATABASE_PATH
        value: "./data/dcr.db"
      - key: ENABLE_OAUTH_AUTH
        value: "true"
      - key: DCR_OAUTH_SCOPE
        value: "offline_access User.Read Mail.Read Mail.ReadWrite Mail.Send Files.Read Files.ReadWrite Calendars.Read Calendars.ReadWrite Notes.Read Notes.ReadWrite"

      # DCR OAuth ì„¤ì • (ë¯¼ê°í•˜ì§€ ì•Šì€ ì •ë³´)
      - key: DCR_AZURE_CLIENT_ID
        value: "88f1daa2-a6cc-4c7b-b575-b76bf0a6435b"
      - key: DCR_AZURE_TENANT_ID
        value: "2da6fff9-9e75-4088-b510-a5d769de35f8"
      - key: DCR_ALLOWED_DOMAINS
        value: "krs.co.kr"
      - key: ENABLE_DCR_ACCOUNT_SYNC
        value: "true"


    healthCheckPath: /health
